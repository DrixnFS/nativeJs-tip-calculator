(function(){const e={tip_margins:{bad:2,good:10,perfect:15},cust_addition:25,price:0,cust_count:1,serv_quality:"bad",tip_price:0,final_price:0,setPrice(r){let t=false;if(Number.isInteger(r)&&r>=0){e.price=r;e.calcTipPrice();e.calcFinalPrice();t=true}return t},setServQuality(r){let t=false;if(e.tip_margins[r]){e.serv_quality=r;e.calcTipPrice();e.calcFinalPrice();t=true}return t},setCustomerCount(r){let t=false;if(Number.isInteger(r)&&r>=1){e.cust_count=r;e.calcTipPrice();e.calcFinalPrice();t=true}return t},calcFinalPrice(){try{let r=e._roundAndFormatPrice(e._getPriceAfterTip()+e._getCustomerAddition());e.final_price=-0==r?0:r}catch(e){console.error(`Error occured in TipHandler.calcFinalPrice:99 -- ${e}`)}},calcTipPrice(){try{e.tip_price=e._getPriceTip()}catch(e){console.error(`Error occured in TipHandler.calcTipPrice:114 -- ${e}`)}},_getCustomerAddition(){return e.cust_count>1?e.cust_addition*(e.cust_count-1):0},_getPriceAfterTip(){return e.price+e._getPriceTip()},_getPriceTip(){return e.price/100*e.tip_margins[e.serv_quality]},_roundAndFormatPrice(e){return(10*Math.ceil(parseFloat(e-1)/10)).toLocaleString()}};const r={handlePriceChange(t){r._resetErrors("price");let n=parseInt(t.currentTarget.value);if(0==n||isNaN(n))r._nullPricesOnError();let i=e.setPrice(n);if(!i){r.handleInputErrors("price");return false}if(!r._isErrPresent())r._updatePrices()},handleQualityChange(t){r._resetErrors("serv_quality");let n=e.setServQuality(t.currentTarget.value);if(!n){r.handleInputErrors("serv_quality");return false}if(!r._isErrPresent())r._updatePrices()},handleCustomerCountChange(t){r._resetErrors("cust_count");let n=parseInt(t.currentTarget.value);if(1==n||isNaN(n))r._nullPricesOnError();let i=e.setCustomerCount(n);if(!i){r.handleInputErrors("cust_count");return false}if(!r._isErrPresent())r._updatePrices()},handleInputErrors(e){if(!e){console.error('ListenerHandler.handleInputErrors:71 - no "type" arg received!');return false}try{let r=document.querySelector(`#main-content label[data-labelType="${e}"]`);r.querySelector("small").classList.add("el-visible");let t=r.querySelector("input")||r.querySelector("select");if(t)t.classList.add("has-error")}catch(e){console.error(`Error occured in ListenerHandler.handleInputErrors:69 -- ${e}`)}},_resetErrors(e){if(!e){console.error('ListenerHandler._resetErrors:90 - no "type" arg received!');return false}let r=document.querySelectorAll(`#main-content label[data-labelType="${e}"] .el-visible`);if(r.length)r.forEach(e=>e.classList.remove("el-visible"));let t=document.querySelectorAll(`#main-content label[data-labelType="${e}"] .has-error`);if(t.length)t.forEach(e=>e.classList.remove("has-error"))},_updatePrices(){document.getElementById("final-price").textContent=e.final_price;document.getElementById("tip-price").textContent=e.tip_price},_nullPricesOnError(){e.final_price=0;e.tip_price=0;r._updatePrices()},_isErrPresent(){return document.querySelectorAll(`#main-content .has-error`).length?true:false}};window.onload=(()=>{document.getElementById("main-price").addEventListener("change",r.handlePriceChange);document.getElementById("main-price").addEventListener("keyup",r.handlePriceChange);document.getElementById("service-quality").addEventListener("change",r.handleQualityChange);document.getElementById("customer-count").addEventListener("change",r.handleCustomerCountChange);document.getElementById("customer-count").addEventListener("keyup",r.handleCustomerCountChange)})})();